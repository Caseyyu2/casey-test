{"version":3,"file":"react-fela.js","sources":["../../../modules/utils/styleTypes.js","../../../modules/dom/DOMInterface.js","../../../modules/utils/warning.js","../../../modules/utils/isValidHTMLElement.js","../../../modules/dom/render.js","../../../modules/bindings/react/Provider.js","../../../modules/bindings/react/connect.js","../../../modules/bindings/react/createComponent.js","../../../modules/bindings/react/ThemeProvider.js","../../../modules/bindings/react/index.js"],"sourcesContent":["/* @flow weak */\nexport const RULE_TYPE = 1\nexport const KEYFRAME_TYPE = 2\nexport const FONT_TYPE = 3\nexport const STATIC_TYPE = 4\nexport const CLEAR_TYPE = 5\n","/* @flow weak */\nimport { RULE_TYPE } from '../utils/styleTypes'\n\nexport default function createDOMInterface(renderer, node) {\n  return change => {\n    // only use insertRule in production as browser devtools might have\n    // weird behavior if used together with insertRule at runtime\n    if (process.env.NODE_ENV === 'production' && change.type === RULE_TYPE && !change.media) {\n      node.sheet.insertRule(change.selector + '{' + change.declaration + '}', node.sheet.cssRules.length)\n    } else {\n      node.textContent = renderer.renderToString()\n    }\n  }\n}\n","/* @flow weak */\nlet warning = () => true\n\nif (process.env.NODE_ENV !== 'production') {\n  warning = (condition, message) => {\n    if (!condition) {\n      if (typeof console !== 'undefined') {\n        console.error(message) // eslint-disable-line\n      }\n    }\n  }\n}\n\nexport default warning\n","export default function isValidHTMLElement(mountNode) {\n  return mountNode && mountNode.nodeType === 1\n}\n","/* @flow weak */\nimport createDOMInterface from './DOMInterface'\nimport warning from '../utils/warning'\nimport isValidHTMLElement from '../utils/isValidHTMLElement'\n\nexport default function render(renderer, mountNode) {\n  // mountNode must be a valid HTML element to be able\n  // to set mountNode.textContent later on\n  if (!isValidHTMLElement(mountNode)) {\n    throw new Error('You need to specify a valid element node (nodeType = 1) to render into.')\n  }\n\n  // warns if the DOM node either is not a valid <style> element thus the styles do not get applied as Expected\n  // or if the node already got the data-fela-stylesheet attribute applied suggesting it is already used by another Renderer\n  warning(mountNode.nodeName === 'STYLE', 'You are using a node other than `<style>`. Your styles might not get applied correctly.')\n  warning(!mountNode.hasAttribute('data-fela-stylesheet'), 'This node is already used by another renderer. Rendering might overwrite other styles.')\n\n  // mark and clean the DOM node to prevent side-effects\n  mountNode.setAttribute('data-fela-stylesheet', '')\n\n  const updateNode = createDOMInterface(renderer, mountNode)\n  renderer.subscribe(updateNode)\n\n  const css = renderer.renderToString()\n\n  if (mountNode.textContent !== css) {\n    // render currently rendered styles to the DOM once\n    mountNode.textContent = css\n  }\n}\n","/* @flow weak */\r\nimport { Component, PropTypes, Children } from 'react'\r\nimport render from '../../dom/render'\r\n\r\nexport default class Provider extends Component {\r\n  static propTypes =  { renderer: PropTypes.object };\r\n  static childContextTypes = { renderer: PropTypes.object };\r\n\r\n  componentDidMount() {\r\n    const { mountNode, renderer } = this.props\r\n\r\n    if (mountNode) {\r\n      render(renderer, mountNode)\r\n    }\n  }\r\n\r\n  getChildContext() {\r\n    return { renderer: this.props.renderer }\n  }\r\n\r\n  render() {\r\n    return Children.only(this.props.children)\n  }\r\n}\r\n","/* @flow weak */\r\nimport React, { Component, PropTypes } from 'react'\r\n\r\nexport default function connect(mapStylesToProps) {\r\n  return Comp => class EnhancedComponent extends Component {\r\n    // reuse the initial displayName name\r\n    static displayName = Comp.displayName || Comp.name || 'ConnectedFelaComponent'\r\n\r\n    static contextTypes = {\r\n      ...Comp.contextTypes,\r\n      renderer: PropTypes.object,\r\n      theme: PropTypes.object\r\n    };\r\n\r\n    render() {\r\n      const { renderer, theme } = this.context\r\n\r\n      const styles = mapStylesToProps({\n        ...this.props,\n        theme: theme || { }\n      })(renderer)\n\r\n      return <Comp {...this.props} styles={styles} />\n    }\r\n  }\n}\n","/* @flow weak */\nimport { createElement, PropTypes } from 'react'\n\nexport default function createComponent(rule, type = 'div', passThroughProps = []) {\n  const FelaComponent = ({ children, className, id, style, passThrough = [], ...ruleProps }, { renderer, theme }) => {\n\n    // filter props to extract props to pass through\n    const componentProps = [ ...passThroughProps, ...passThrough ].reduce((output, prop) => {\n      output[prop] = ruleProps[prop]\n      return output\n    }, { })\n\n    componentProps.style = style\n    componentProps.id = id\n\n    const cls = className ? className + ' ' : ''\n    ruleProps.theme = theme || { }\n\n    componentProps.className = cls + renderer.renderRule(rule, ruleProps)\n    return createElement(type, componentProps, children)\n  }\n\n  FelaComponent.contextTypes = {\n    renderer: PropTypes.object,\n    theme: PropTypes.object\n  }\n\n  // use the rule name as display name to better debug with react inspector\n  FelaComponent.displayName = rule.name && rule.name || 'FelaComponent'\n  return FelaComponent\n}\n","/* @flow weak */\r\nimport { Component, PropTypes, Children } from 'react'\r\n\r\nexport default class ThemeProvider extends Component {\r\n  static propTypes =  { theme: PropTypes.object, overwrite: PropTypes.bool };\r\n  static childContextTypes = { theme: PropTypes.object };\r\n  static contextTypes = { theme: PropTypes.object };\r\n\r\n  getChildContext() {\r\n    const { overwrite, theme } = this.props\r\n    const previousTheme = this.context.theme\r\n\r\n    return {\r\n      theme: {\r\n        ...(!overwrite && previousTheme || {}),\r\n        ...theme\r\n      }\r\n    }\n  }\r\n\r\n  render() {\r\n    return Children.only(this.props.children)\n  }\r\n}\r\n","/* @flow weak */\nimport Provider from './Provider'\nimport connect from './connect'\nimport createComponent from './createComponent'\nimport ThemeProvider from './ThemeProvider'\n\nexport default {\n  Provider,\n  connect,\n  createComponent,\n  ThemeProvider\n}\n"],"names":["RULE_TYPE","createDOMInterface","renderer","node","change","type","media","textContent","renderToString","warning","condition","message","console","error","isValidHTMLElement","mountNode","nodeType","render","Error","nodeName","hasAttribute","setAttribute","updateNode","subscribe","css","Provider","props","Children","only","children","Component","propTypes","PropTypes","object","childContextTypes","connect","mapStylesToProps","context","theme","styles","React","displayName","Comp","name","contextTypes","createComponent","rule","passThroughProps","FelaComponent","className","id","style","passThrough","ruleProps","componentProps","reduce","output","prop","cls","renderRule","createElement","ThemeProvider","overwrite","previousTheme","bool"],"mappings":"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"}